{
  "name": "Security Hardening Policies",
  "description": "This repo provides modules implementing various security hardening measures.",
  "type": "module-repo",
  "provides": {
    "default-encrypt-method-sha512": {
      "description": "This module makes sure the default password hashing algorithm is SHA512.",
      "tags": ["security"],
      "subdirectory": "./default-encrypt-method-sha512/",
      "version": "1.0.3",
      "by": "https://github.com/nickanderson",
      "repo": "https://github.com/nickanderson/cfengine-security-hardening",
      "steps": [
        "copy ./policy/default-encrypt-method-sha512.cf services/security-hardening/default-encrypt-method-sha512/default-encrypt-method-sha512.cf",
        "json cfbs/def.json def.json"
      ]
    },
    "ssh-permit-root-login-no": {
      "description": "This module ensures that PermitRootLogin is set to no.",
      "tags": ["security"],
      "subdirectory": "./ssh-permit-root-login-no/",
      "version": "1.0.3",
      "by": "https://github.com/nickanderson",
      "repo": "https://github.com/nickanderson/cfengine-security-hardening",
      "dependencies": ["library-sshd-config"],
      "steps": [
        "copy ./ssh-permit-root-login-no.cf services/security-hardening/ssh-permit-root-login-no/",
        "json cfbs/def.json def.json"
      ]
    },
    "ssh-permit-empty-passwords-no": {
      "description": "This module ensures that PermitEmptyPasswords is set to no.",
      "tags": ["security"],
      "subdirectory": "./ssh-permit-empty-passwords-no/",
      "version": "1.0.3",
      "by": "https://github.com/nickanderson",
      "repo": "https://github.com/nickanderson/cfengine-security-hardening",
      "dependencies": ["library-sshd-config"],
      "steps": [
        "copy ./ssh-permit-empty-passwords-no.cf services/security-hardening/ssh-permit-empty-passwords-no/",
        "json cfbs/def.json def.json"
      ]
    },
    "ssh-ciphers-strong": {
      "description": "This module ensures that Ciphers is set to a list of ciphers considered to be strong.",
      "tags": ["security"],
      "subdirectory": "./ssh-ciphers-strong/",
      "version": "1.0.4",
      "by": "https://github.com/nickanderson",
      "repo": "https://github.com/nickanderson/cfengine-security-hardening",
      "dependencies": ["library-sshd-config"],
      "steps": [
        "copy ./ssh-ciphers-strong.cf services/security-hardening/ssh-ciphers-strong/",
        "json cfbs/def.json def.json"
      ]
    },
    "compliance-report-imports": {
      "name": "compliance-report-imports",
      "version": "0.0.5",
      "tags": ["experimental", "cfengine-enterprise"],
      "dependencies": ["autorun"],
      "subdirectory": "./compliance-report-imports",
      "description": "Keep compliance report definitions up to date",
      "steps": ["copy ./compliance-report-imports.cf services/autorun/"]
    },
    "compliance-report-os-is-vendor-supported": {
      "name": "compliance-report-os-is-vendor-supported",
      "version": "0.0.2",
      "tags": ["experimental", "compliance-report", "cfengine-enterprise"],
      "dependencies": ["compliance-report-imports"],
      "subdirectory": "./compliance-report-os-is-vendor-supported",
      "description": "Compliance report definition for checking if the current OS version is supported by the vendor",
      "steps": [
        "copy ./os-is-vendor-supported.json .no-distrib/compliance-report-definitions/os-is-vendor-supported.json"
      ]
    },
    "sudo-enforce-allowed-users": {
      "description": "This module ensures the following lines 'ALL ALL=(ALL) ALL' and 'ALL ALL=(ALL:ALL) ALL' are not present in /etc/sudoers.conf",
      "tags": ["security", "management"],
      "subdirectory": "./sudo-enforce-allowed-users/",
      "version": "0.0.2",
      "by": "https://github.com/nickanderson",
      "repo": "https://github.com/nickanderson/cfengine-security-hardening",
      "steps": [
        "copy ./sudo-enforce-allowed-users.cf services/security-hardening/sudo-enforce-allowed-users/",
        "json cfbs/def.json def.json"
      ]
    },
    "tmp-file-age": {
      "description": "This module inventories and manages old files in /tmp.",
      "tags": ["security"],
      "subdirectory": "./tmp-file-age/",
      "version": "0.0.1",
      "by": "https://github.com/nickanderson",
      "repo": "https://github.com/nickanderson/cfengine-security-hardening",
      "steps": [
        "copy ./tmp-file-age.cf services/security-hardening/tmp-file-age/",
        "json cfbs/def.json def.json"
      ]
    },
    "cve-2021-44228-log4j": {
      "description": "This module leverages yahoo/check-log4j to scan for files potentially vulnerable to CVE-2021-44228, which allows arbitrary code execution.",
      "tags": ["security"],
      "subdirectory": "./cves/cve-2021-44228-log4j/",
      "version": "0.0.1",
      "by": "https://github.com/nickanderson",
      "repo": "https://github.com/nickanderson/cfengine-security-hardening",
      "steps": [
        "copy ./cve-2021-44228-log4j-inventory-log4shell.cf services/security-hardening/cves/cve-2021-44228-log4j/",
        "json cfbs/def.json def.json"
      ]
    },
    "cve-2021-3156-sudo": {
      "description": "This module inventories and remediates CVE-2021-3156, a heap overflow in sudo that allows privilege escalation.",
      "tags": ["security"],
      "subdirectory": "./cves/cve-2021-3156-sudo/",
      "version": "0.0.1",
      "by": "https://github.com/nickanderson",
      "repo": "https://github.com/nickanderson/cfengine-security-hardening",
      "steps": [
        "copy ./cve-2021-3156-sudo.cf services/security-hardening/cves/cve-2021-3156-sudo/",
        "json cfbs/def.json def.json"
      ]
    },
    "ntp-maxpoll": {
      "description": "This module ensures that maxpoll is configured to 10 unless default:ntp_maxpoll._config[maxpoll] is defined in which case that value will be used.",
      "tags": ["security"],
      "subdirectory": "./ntp-maxpoll/",
      "version": "0.0.3",
      "by": "https://github.com/nickanderson",
      "repo": "https://github.com/nickanderson/cfengine-security-hardening",
      "steps": [
        "copy ./ntp-maxpoll.cf services/security-hardening/ntp-maxpoll/",
        "json cfbs/def.json def.json"
      ]
    },
    "ssh-x11-forwarding-no": {
      "description": "This module ensures that X11Forwarding is set to no.",
      "tags": ["security"],
      "subdirectory": "./ssh-x11-forwarding-no/",
      "version": "1.0.3",
      "by": "https://github.com/nickanderson",
      "repo": "https://github.com/nickanderson/cfengine-security-hardening",
      "dependencies": ["library-sshd-config"],
      "steps": [
        "copy ./ssh-x11-forwarding-no.cf services/security-hardening/ssh-x11-forwarding-no/",
        "json cfbs/def.json def.json"
      ]
    },
    "ssh-max-auth-tries": {
      "description": "This module ensures that MaxAuthTries is set, defaulting to 3.",
      "tags": ["security"],
      "subdirectory": "./ssh-max-auth-tries/",
      "version": "1.0.3",
      "by": "https://github.com/nickanderson",
      "repo": "https://github.com/nickanderson/cfengine-security-hardening",
      "dependencies": ["library-sshd-config"],
      "steps": [
        "copy ./ssh-max-auth-tries.cf services/security-hardening/ssh-max-auth-tries/",
        "json cfbs/def.json def.json"
      ]
    },
    "ssh-protocol-2": {
      "description": "This module ensures that only Protocol 2 is in use.",
      "tags": ["security"],
      "subdirectory": "./ssh-protocol-2/",
      "version": "1.0.3",
      "by": "https://github.com/nickanderson",
      "repo": "https://github.com/nickanderson/cfengine-security-hardening",
      "dependencies": ["library-sshd-config"],
      "steps": [
        "copy ./ssh-protocol-2.cf services/security-hardening/ssh-protocol-2/",
        "json cfbs/def.json def.json"
      ]
    }
  }
}
